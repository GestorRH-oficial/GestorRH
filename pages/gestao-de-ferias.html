<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão de Férias</title>
    <link rel="stylesheet" href="../CSS/gestao_ferias.css">
</head>
<body>

<div class="container">

    <header>
        <h1>Gestão de Férias</h1>
    </header>

    <main class="grid">

        <!-- FORMULÁRIO -->
        <section class="card">

            <label>Colaborador</label>
            <select id="employee">
                <option>Selecione...</option>
                <option>Josimar da Silva</option>
                <option>Samuel</option>
                <option>Oduvaldo</option>
            </select>

            <label>Período de férias</label>
            <div class="row">
                <div style="flex:1">
                    <label>Saída 1</label>
                    <input type="date" id="saida1">

                    <label>Saída 2</label>
                    <input type="date" id="saida2">
                </div>

                <div style="flex:1">
                    <label>Retorno 1</label>
                    <input type="date" id="retorno1">

                    <label>Retorno 2</label>
                    <input type="date" id="retorno2">
                </div>
            </div>

            <label>Tipo</label>
            <div class="row">
                <label><input type="radio" name="tipo" value="integral" checked> Integral</label>
                <label><input type="radio" name="tipo" value="parcial"> Parcial</label>
            </div>

            <div id="partialBlock" class="partial-block">
                <label>Dias descansados</label>
                <input type="number" min="1" max="30" id="diasParciais">
            </div>

            <label>Observações</label>
            <textarea id="obs" rows="4"></textarea>

            <label><input type="checkbox" id="sellDays"> Vender dias</label>

            <div id="sellBlock" class="sell-block">
                <label>Dias a vender</label>
                <input type="number" min="1" max="10" id="diasVenda">
            </div>

            <div class="aprovacao-pendente" id="aprovacaoPendente">
                <strong>Aprovado! Confirmação pendente</strong>
            </div>

            <div style="margin-top: 15px;">
                <button class="btn success" id="btnAprovar">Aprovar</button>
                <button class="btn danger" id="btnLimparTudo">Limpar Tudo</button>
            </div>

        </section>

        <!-- RESUMO -->
        <aside class="card">
            <h2>Resumo</h2>
            <p id="resumoTexto">Nenhum resumo disponível ainda...</p>
        </aside>

    </main>
</div>

<!-- MODAL -->
<div class="modal" id="modalConfirmacao">
    <div class="modal-content">
        <h2>Confirmar aprovação?</h2>
        <p>Deseja realmente aprovar esta solicitação?</p>

        <div class="modal-buttons">
            <button class="btn secondary" id="btnCancelar">Cancelar</button>
            <button class="btn success" id="btnConfirmar">Confirmar</button>
        </div>
    </div>
</div>

<script>

    // CAMPOS
    const employee = document.getElementById("employee");
    const saida1 = document.getElementById("saida1");
    const saida2 = document.getElementById("saida2");
    const retorno1 = document.getElementById("retorno1");
    const retorno2 = document.getElementById("retorno2");
    const obs = document.getElementById("obs");
    const sellDays = document.getElementById("sellDays");
    const diasVenda = document.getElementById("diasVenda");
    const diasParciais = document.getElementById("diasParciais");

    const partialBlock = document.getElementById('partialBlock');
    const sellBlock = document.getElementById('sellBlock');
    const resumo = document.getElementById("resumoTexto");

    // BOTÕES
    const btnAprovar = document.getElementById("btnAprovar");
    const btnCancelar = document.getElementById("btnCancelar");
    const btnConfirmar = document.getElementById("btnConfirmar");
    const btnLimparTudo = document.getElementById("btnLimparTudo");

    const modalConfirmacao = document.getElementById("modalConfirmacao");
    const aprovacaoPendente = document.getElementById("aprovacaoPendente");


    // ====== EXIBE OS CAMPOS ADICIONAIS ======
    document.querySelectorAll('input[name="tipo"]').forEach(radio => {
        radio.addEventListener("change", () => {
            partialBlock.style.display = radio.value === "parcial" ? "block" : "none";
        });
    });

    sellDays.addEventListener("change", () => {
        sellBlock.style.display = sellDays.checked ? "block" : "none";
    });


    // ====== MONTA O RESUMO SOMENTE APÓS APROVAR ======
    function gerarResumo() {

        const tipo = document.querySelector('input[name="tipo"]:checked').value;

        let texto = `
            <strong>Colaborador:</strong> ${employee.value}<br><br>
            <strong>Período:</strong><br>
            • Saída 1: ${saida1.value}<br>
            • Saída 2: ${saida2.value}<br>
            • Retorno 1: ${retorno1.value}<br>
            • Retorno 2: ${retorno2.value}<br><br>
            <strong>Tipo:</strong> ${tipo}<br><br>
        `;

        if (tipo === "parcial") {
            texto += `• Dias descansados: ${diasParciais.value}<br><br>`;
        }

        texto += `
            <strong>Observações:</strong><br>
            ${obs.value || "Nenhuma"}<br><br>
        `;

        texto += sellDays.checked
            ? `<strong>Venda de dias:</strong> Vendendo ${diasVenda.value} dia(s)`
            : `<strong>Venda de dias:</strong> Não venderá dias.`;

        resumo.innerHTML = texto;
    }


    // ====== ABRIR MODAL ======
    btnAprovar.onclick = () => modalConfirmacao.style.display = "flex";


    // ====== CANCELAR APAGA TUDO ======
    btnCancelar.onclick = limparTudo;


    // ====== CONFIRMAR APROVAÇÃO ======
    btnConfirmar.onclick = () => {

        modalConfirmacao.style.display = "none";

        gerarResumo();

        aprovacaoPendente.classList.add("mostrar");

        btnAprovar.disabled = true;
        btnAprovar.style.background = "#777";
        btnAprovar.style.cursor = "not-allowed";
        btnAprovar.textContent = "Aprovado";

        // remover mensagem após 3 segundos
        setTimeout(() => {
            aprovacaoPendente.classList.remove("mostrar");
        }, 3000);

        limparCampos();
    };


    // ====== LIMPAR TUDO ======
    btnLimparTudo.onclick = limparTudo;


    function limparCampos() {
        document.querySelectorAll("input, textarea, select").forEach(el => el.value = "");

        partialBlock.style.display = "none";
        sellBlock.style.display = "none";
        sellDays.checked = false;

        document.querySelector('input[name="tipo"][value="integral"]').checked = true;
    }


    function limparTudo() {
        modalConfirmacao.style.display = "none";
        aprovacaoPendente.classList.remove("mostrar");
        resumo.innerHTML = "Nenhum resumo disponível ainda...";

        btnAprovar.disabled = false;
        btnAprovar.textContent = "Aprovar";
        btnAprovar.style.background = "#28a745";
        btnAprovar.style.cursor = "pointer";

        limparCampos();
    }


    // FECHAR MODAL CLICANDO FORA
    window.onclick = e => {
        if (e.target === modalConfirmacao) modalConfirmacao.style.display = "none";
    };

</script>
 <a href="../pages/menu.html"><button class="voltar">voltar</button></a>

</body>

</html>